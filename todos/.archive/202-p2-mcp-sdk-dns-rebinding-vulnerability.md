# TODO: Address MCP SDK DNS Rebinding Vulnerability

**Priority:** P2 - Important
**Category:** Security
**Detected:** 2025-12-24 (npm audit)
**Status:** resolved
**Resolved:** 2025-12-24

## Problem

2 high severity vulnerabilities in MCP (Model Context Protocol) SDK:

```
Severity: high
Model Context Protocol (MCP) TypeScript SDK does not enable DNS rebinding protection by default
https://github.com/advisories/GHSA-w48q-cv73-mx4w
No fix available
node_modules/@modelcontextprotocol/server-puppeteer/node_modules/@modelcontextprotocol/sdk
```

Total vulnerabilities: 6 (2 low, 2 moderate, 2 high)

## Resolution

**Implemented Option D: Removed @modelcontextprotocol/server-puppeteer**

### Investigation Findings

1. `@modelcontextprotocol/server-puppeteer` was a devDependency (Claude Code tooling only)
2. It used outdated `@modelcontextprotocol/sdk@1.0.1` (vulnerable < 1.24.0)
3. Other MCP servers already use `@modelcontextprotocol/sdk@1.25.1` (patched)
4. Playwright MCP (`@playwright/mcp`) is already configured and provides equivalent browser automation
5. The server-puppeteer package hasn't been updated since 2025-05-12, before the SDK fix (2025-12-03)

### Changes Made

1. Removed `@modelcontextprotocol/server-puppeteer` from `package.json` devDependencies
2. Removed `puppeteer` from `.claude/settings.local.json` enabledMcpjsonServers
3. Ran `npm install` to clean up the dependency tree

### Verification

```bash
$ npm audit
4 vulnerabilities (2 low, 2 moderate)
# High severity count reduced from 2 to 0
```

## Impact

- DNS rebinding attacks possible against MCP servers
- Security audit failures
- Potential compliance issues

## Previous Options Considered

1. **Option A**: Enable DNS rebinding protection manually - Not exposed in SDK config
2. **Option B**: Isolate MCP usage to development-only - Already dev-only, but still a risk
3. **Option C**: Monitor for upstream fix - server-puppeteer hasn't been updated in 7+ months
4. **Option D**: Remove server-puppeteer - IMPLEMENTED - Playwright MCP provides equivalent functionality

## Files Modified

- `package.json` - Removed `@modelcontextprotocol/server-puppeteer` devDependency
- `.claude/settings.local.json` - Removed `puppeteer` from enabledMcpjsonServers

## Testing

- [x] `npm audit` - High severity count is now 0
- [x] Playwright MCP still available for browser automation via `.mcp.json`
